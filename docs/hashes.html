<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.8.3" />
<title>botw.hashes API documentation</title>
<meta name="description" content="Provides hash tables for unmodified game files using xxHash" />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js" integrity="sha256-eOgo0OtLL4cdq7RdwRUiGKLX9XsIJ7nGhWEKbohmVAQ=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>botw.hashes</code></h1>
</header>
<section id="section-intro">
<p>Provides hash tables for unmodified game files using xxHash</p>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">&#34;&#34;&#34; Provides hash tables for unmodified game files using xxHash &#34;&#34;&#34;
# pylint: disable=bad-continuation
from json import loads
from functools import lru_cache
from typing import ByteString, Dict, Iterator, List, Union
from xxhash import xxh32_intdigest

from oead.yaz0 import decompress
from . import DATA_DIR


@lru_cache(None)
def get_wiiu_hash_table() -&gt; Dict[str, List[int]]:
    &#34;&#34;&#34;
    Gets a hash table for game files in the unmodified 1.5.0 Wii U version of
    BOTW. It comes as a dict with canonical path names as keys and lists of int
    values. The list contains multiple possible hashes for files with no
    modified content, including dirty versions affected by automatic processing
    through libraries and tools.
    &#34;&#34;&#34;
    return loads((DATA_DIR / &#34;wiiu_hashes.json&#34;).read_text(&#34;utf-8&#34;))


@lru_cache(None)
def get_switch_hash_table() -&gt; Dict[str, List[int]]:
    &#34;&#34;&#34;
    Gets a hash table for game files in the unmodified 1.5.0 Switch version of
    BOTW. It comes as a dict with canonical path names as keys and lists of int
    values. The list contains multiple possible hashes for files with no
    modified content, including dirty versions affected by automatic processing
    through libraries and tools.
    &#34;&#34;&#34;
    return loads((DATA_DIR / &#34;switch_hashes.json&#34;).read_text(&#34;utf-8&#34;))


class StockHashTable:
    &#34;&#34;&#34; A class wrapping a hash table for stock BOTW files with a few
    convenience methods. &#34;&#34;&#34;

    _table: Dict[str, List[int]]

    def __init__(self, wiiu: bool):
        table = get_wiiu_hash_table() if wiiu else get_switch_hash_table()
        self._table = {file: set(xhashes) for file, xhashes in table.items()}
        del table

    @lru_cache(None)
    def is_file_modded(
        self, file_name: str, data: Union[ByteString, int], flag_new: bool = True
    ) -&gt; bool:
        &#34;&#34;&#34;Checks a file to see if it has been modified. Automatically decompresses yaz0 data.

        Args:
            file_name (str): The canonical resource path of the file to check
            data (Union[ByteString, int]): Either the file data (as a byteslike object) or an xxh32
                hash as an int
            flag_new (bool, optional): Whether to flag new files (not in vanilla BOTW) as modified.
                Defaults to True.

        Returns:
            bool: Returns whether the file&#39;s hash matches a known version of the hash for the
                original version.
        &#34;&#34;&#34;
        if file_name not in self._table:
            return flag_new
        else:
            if isinstance(data, int):
                return data not in self._table[file_name]
            if data[0:4] == b&#34;Yaz0&#34;:
                data = decompress(data)
            return xxh32_intdigest(data) not in self._table[file_name]

    @lru_cache(None)
    def is_file_new(self, file_name: str) -&gt; bool:
        &#34;&#34;&#34;Checks if a file is present in the unmodded game.

        Args:
            file_name (str): The canonical resource path of the file to check

        Returns:
            bool: Returns True if the file is present in the stock hash table.
        &#34;&#34;&#34;
        return file_name in self._table

    def get_stock_files(self) -&gt; Iterator[str]:
        &#34;&#34;&#34;Iterates the files in the stock hash table by their canonical resource paths.

        Yields:
            Iterator[str]: Iterator for stock files in hash table
        &#34;&#34;&#34;
        for file in self._table:
            yield file

    def list_stock_files(self) -&gt; List[str]:
        &#34;&#34;&#34;Lists all of the files in the stock hash table by their canonical resource paths.

        Returns:
            List[str]: List of stock files in hash table
        &#34;&#34;&#34;
        return list(self._table.keys())</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="botw.hashes.get_switch_hash_table"><code class="name flex">
<span>def <span class="ident">get_switch_hash_table</span></span>(<span>) ‑> Dict[str, List[int]]</span>
</code></dt>
<dd>
<div class="desc"><p>Gets a hash table for game files in the unmodified 1.5.0 Switch version of
BOTW. It comes as a dict with canonical path names as keys and lists of int
values. The list contains multiple possible hashes for files with no
modified content, including dirty versions affected by automatic processing
through libraries and tools.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@lru_cache(None)
def get_switch_hash_table() -&gt; Dict[str, List[int]]:
    &#34;&#34;&#34;
    Gets a hash table for game files in the unmodified 1.5.0 Switch version of
    BOTW. It comes as a dict with canonical path names as keys and lists of int
    values. The list contains multiple possible hashes for files with no
    modified content, including dirty versions affected by automatic processing
    through libraries and tools.
    &#34;&#34;&#34;
    return loads((DATA_DIR / &#34;switch_hashes.json&#34;).read_text(&#34;utf-8&#34;))</code></pre>
</details>
</dd>
<dt id="botw.hashes.get_wiiu_hash_table"><code class="name flex">
<span>def <span class="ident">get_wiiu_hash_table</span></span>(<span>) ‑> Dict[str, List[int]]</span>
</code></dt>
<dd>
<div class="desc"><p>Gets a hash table for game files in the unmodified 1.5.0 Wii U version of
BOTW. It comes as a dict with canonical path names as keys and lists of int
values. The list contains multiple possible hashes for files with no
modified content, including dirty versions affected by automatic processing
through libraries and tools.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@lru_cache(None)
def get_wiiu_hash_table() -&gt; Dict[str, List[int]]:
    &#34;&#34;&#34;
    Gets a hash table for game files in the unmodified 1.5.0 Wii U version of
    BOTW. It comes as a dict with canonical path names as keys and lists of int
    values. The list contains multiple possible hashes for files with no
    modified content, including dirty versions affected by automatic processing
    through libraries and tools.
    &#34;&#34;&#34;
    return loads((DATA_DIR / &#34;wiiu_hashes.json&#34;).read_text(&#34;utf-8&#34;))</code></pre>
</details>
</dd>
</dl>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="botw.hashes.StockHashTable"><code class="flex name class">
<span>class <span class="ident">StockHashTable</span></span>
<span>(</span><span>wiiu: bool)</span>
</code></dt>
<dd>
<div class="desc"><p>A class wrapping a hash table for stock BOTW files with a few
convenience methods.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class StockHashTable:
    &#34;&#34;&#34; A class wrapping a hash table for stock BOTW files with a few
    convenience methods. &#34;&#34;&#34;

    _table: Dict[str, List[int]]

    def __init__(self, wiiu: bool):
        table = get_wiiu_hash_table() if wiiu else get_switch_hash_table()
        self._table = {file: set(xhashes) for file, xhashes in table.items()}
        del table

    @lru_cache(None)
    def is_file_modded(
        self, file_name: str, data: Union[ByteString, int], flag_new: bool = True
    ) -&gt; bool:
        &#34;&#34;&#34;Checks a file to see if it has been modified. Automatically decompresses yaz0 data.

        Args:
            file_name (str): The canonical resource path of the file to check
            data (Union[ByteString, int]): Either the file data (as a byteslike object) or an xxh32
                hash as an int
            flag_new (bool, optional): Whether to flag new files (not in vanilla BOTW) as modified.
                Defaults to True.

        Returns:
            bool: Returns whether the file&#39;s hash matches a known version of the hash for the
                original version.
        &#34;&#34;&#34;
        if file_name not in self._table:
            return flag_new
        else:
            if isinstance(data, int):
                return data not in self._table[file_name]
            if data[0:4] == b&#34;Yaz0&#34;:
                data = decompress(data)
            return xxh32_intdigest(data) not in self._table[file_name]

    @lru_cache(None)
    def is_file_new(self, file_name: str) -&gt; bool:
        &#34;&#34;&#34;Checks if a file is present in the unmodded game.

        Args:
            file_name (str): The canonical resource path of the file to check

        Returns:
            bool: Returns True if the file is present in the stock hash table.
        &#34;&#34;&#34;
        return file_name in self._table

    def get_stock_files(self) -&gt; Iterator[str]:
        &#34;&#34;&#34;Iterates the files in the stock hash table by their canonical resource paths.

        Yields:
            Iterator[str]: Iterator for stock files in hash table
        &#34;&#34;&#34;
        for file in self._table:
            yield file

    def list_stock_files(self) -&gt; List[str]:
        &#34;&#34;&#34;Lists all of the files in the stock hash table by their canonical resource paths.

        Returns:
            List[str]: List of stock files in hash table
        &#34;&#34;&#34;
        return list(self._table.keys())</code></pre>
</details>
<h3>Methods</h3>
<dl>
<dt id="botw.hashes.StockHashTable.get_stock_files"><code class="name flex">
<span>def <span class="ident">get_stock_files</span></span>(<span>self) ‑> Iterator[str]</span>
</code></dt>
<dd>
<div class="desc"><p>Iterates the files in the stock hash table by their canonical resource paths.</p>
<h2 id="yields">Yields</h2>
<dl>
<dt><code>Iterator[str]</code></dt>
<dd>Iterator for stock files in hash table</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_stock_files(self) -&gt; Iterator[str]:
    &#34;&#34;&#34;Iterates the files in the stock hash table by their canonical resource paths.

    Yields:
        Iterator[str]: Iterator for stock files in hash table
    &#34;&#34;&#34;
    for file in self._table:
        yield file</code></pre>
</details>
</dd>
<dt id="botw.hashes.StockHashTable.is_file_modded"><code class="name flex">
<span>def <span class="ident">is_file_modded</span></span>(<span>self, file_name: str, data: Union[ByteString, int], flag_new: bool = True) ‑> bool</span>
</code></dt>
<dd>
<div class="desc"><p>Checks a file to see if it has been modified. Automatically decompresses yaz0 data.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>file_name</code></strong> :&ensp;<code>str</code></dt>
<dd>The canonical resource path of the file to check</dd>
<dt><strong><code>data</code></strong> :&ensp;<code>Union[ByteString, int]</code></dt>
<dd>Either the file data (as a byteslike object) or an xxh32
hash as an int</dd>
<dt><strong><code>flag_new</code></strong> :&ensp;<code>bool</code>, optional</dt>
<dd>Whether to flag new files (not in vanilla BOTW) as modified.
Defaults to True.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>bool</code></dt>
<dd>Returns whether the file's hash matches a known version of the hash for the
original version.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@lru_cache(None)
def is_file_modded(
    self, file_name: str, data: Union[ByteString, int], flag_new: bool = True
) -&gt; bool:
    &#34;&#34;&#34;Checks a file to see if it has been modified. Automatically decompresses yaz0 data.

    Args:
        file_name (str): The canonical resource path of the file to check
        data (Union[ByteString, int]): Either the file data (as a byteslike object) or an xxh32
            hash as an int
        flag_new (bool, optional): Whether to flag new files (not in vanilla BOTW) as modified.
            Defaults to True.

    Returns:
        bool: Returns whether the file&#39;s hash matches a known version of the hash for the
            original version.
    &#34;&#34;&#34;
    if file_name not in self._table:
        return flag_new
    else:
        if isinstance(data, int):
            return data not in self._table[file_name]
        if data[0:4] == b&#34;Yaz0&#34;:
            data = decompress(data)
        return xxh32_intdigest(data) not in self._table[file_name]</code></pre>
</details>
</dd>
<dt id="botw.hashes.StockHashTable.is_file_new"><code class="name flex">
<span>def <span class="ident">is_file_new</span></span>(<span>self, file_name: str) ‑> bool</span>
</code></dt>
<dd>
<div class="desc"><p>Checks if a file is present in the unmodded game.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>file_name</code></strong> :&ensp;<code>str</code></dt>
<dd>The canonical resource path of the file to check</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>bool</code></dt>
<dd>Returns True if the file is present in the stock hash table.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@lru_cache(None)
def is_file_new(self, file_name: str) -&gt; bool:
    &#34;&#34;&#34;Checks if a file is present in the unmodded game.

    Args:
        file_name (str): The canonical resource path of the file to check

    Returns:
        bool: Returns True if the file is present in the stock hash table.
    &#34;&#34;&#34;
    return file_name in self._table</code></pre>
</details>
</dd>
<dt id="botw.hashes.StockHashTable.list_stock_files"><code class="name flex">
<span>def <span class="ident">list_stock_files</span></span>(<span>self) ‑> List[str]</span>
</code></dt>
<dd>
<div class="desc"><p>Lists all of the files in the stock hash table by their canonical resource paths.</p>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>List[str]</code></dt>
<dd>List of stock files in hash table</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def list_stock_files(self) -&gt; List[str]:
    &#34;&#34;&#34;Lists all of the files in the stock hash table by their canonical resource paths.

    Returns:
        List[str]: List of stock files in hash table
    &#34;&#34;&#34;
    return list(self._table.keys())</code></pre>
</details>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="botw" href="index.html">botw</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="botw.hashes.get_switch_hash_table" href="#botw.hashes.get_switch_hash_table">get_switch_hash_table</a></code></li>
<li><code><a title="botw.hashes.get_wiiu_hash_table" href="#botw.hashes.get_wiiu_hash_table">get_wiiu_hash_table</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="botw.hashes.StockHashTable" href="#botw.hashes.StockHashTable">StockHashTable</a></code></h4>
<ul class="">
<li><code><a title="botw.hashes.StockHashTable.get_stock_files" href="#botw.hashes.StockHashTable.get_stock_files">get_stock_files</a></code></li>
<li><code><a title="botw.hashes.StockHashTable.is_file_modded" href="#botw.hashes.StockHashTable.is_file_modded">is_file_modded</a></code></li>
<li><code><a title="botw.hashes.StockHashTable.is_file_new" href="#botw.hashes.StockHashTable.is_file_new">is_file_new</a></code></li>
<li><code><a title="botw.hashes.StockHashTable.list_stock_files" href="#botw.hashes.StockHashTable.list_stock_files">list_stock_files</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc"><cite>pdoc</cite> 0.8.3</a>.</p>
</footer>
</body>
</html>